<html>



<iframe id="test_1_frame" width="700px" height="700px" src="index.html" onLoad="iframeLoaded()">
</iframe>
<textarea id="textArea" width="700px" height="40px">
</textarea>
</html>

<script>

	var iframe = document.getElementById("test_1_frame");

	var iframe_doc;


	function addIframeIndicatorToAllElements() {

	}


	function iframeLoaded() {
		iframe_doc = iframe.contentDocument;
		iframe.onmouseover = function(theEvent){onMouseOverInFrame(theEvent, iframe_doc);}
	}

	function onMouseOverInFrame(e, frame) {

		//should in fact try and show only the bottomost child when mouseover, use the html to select whole table

		var event = e || frame.event;

		var target = event.target || event.srcElement;

		target.onclick = function() { onClickedIframeElement(target); };
	}

	function onClickedIframeElement(targetElement) {

		var uniqueAttributes = DetermineUniqueAttributes(targetElement, iframe_doc);



		if(uniqueAttributes[0] == "THERE IS NO UNIQUE") {
			//shouldnt happen
		}

		var searchTree = Array;

		var searchTreeTemp = Array;

		//will start by identifying the parent
		uniqueAttributes.forEach(function(elementAttributeValue, elementAttributeType) {
			if(elementAttributesToMatch.length==1) {
				if(elementAttributeType == "id") {
					searchTreeTemp = iframe.getElementById(elementAttributeValue);
				}
				else{

				}
			}
		});

		var currentMatch;

		//is the list of children

		var currentMatchList;

		var currentSearchList;

		var parentTree = iframe;

		uniqueAttributes.forEach(function(matchAttributesList) {

			matchAttributesList.forEach(function(attributeValue, attributeType) {

				if(attributeType == "id") {
					currentMatch = parentTree.getElementById(attributeValue);
				}
				else{
					if(attributeType == "class") {
						currentMatchList = parentTree.getElementsByClassName(attributeValue);
						if(currentMatchList.length == 1) {

						}
					}
				}

			});


			if(matchAttributesList.length == 1) {


				matchAttributesList

				if(matchAttributesList[0][0] == "id") {
					currentMatch = iframe.getElementById(matchAttributesList[0][1]);
				}
				else if(matchAttributesList[0][0] == "class") {
					currentMatch = iframe.getElementsByClassName(matchAttributesList[0][1]);
				}
				else if(matchAttributesList[0][0] == "class") {
					currentMatch = iframe.getElementsByClassName(matchAttributesList[0][1]);
				}
			}
		});



		uniqueAttributes.forEach(function(elementAttributeValue, elementAttributeType) {
			if(elementAttributesToMatch.length==1) {
				if(elementAttributeType == "id") {
					searchTreeTemp = iframe.getElementById(elementAttributeValue);
				}
				else{
					
				}
			}
		});


	}

	function DetermineUniqueAttributes(element, searchTree) {



		var reducedSearchTree = searchTree; 

		var elementAttributes = element.attributes;
		var attributeValue;

		var elementTagName = element.tagName;


		var attributeTypeArray = Array;

		var uniqueAttributesArray = Array;

		var arrayIndex;

		var returnArray = Array;

		//if there is id, just use this really...
		if( elementAttributes.match("id") ) {



			attributeTypeArray["id"] = element.id;

			arrayIndex = elementAttributes.indexOf("id");

			if (arrayIndex > -1) {
   				elementAttributes.splice(arrayIndex, 1);
			}

			if((reducedSearchTree = reducedSearchTree.getElementById(attributeTypeArray["id"])).length == 1)  {
			
				returnArray.push(attributeTypeArray);
				return returnArray;
			}
		}
		if( elementAttributes.match("class") ) {
			attributeTypeArray["class"] = element.class;

			arrayIndex = elementAttributes.indexOf("class");
			if (arrayIndex > -1) {
   				elementAttributes.splice(arrayIndex, 1);
			}

			if((reducedSearchTree = reducedSearchTree.getElementsByClassName(attributeTypeArray["class"])).length == 1) {
			
				returnArray.push(attributeTypeArray);
				return returnArray;
			}
		}

		//everything has a tag
		attributeTypeArray["tagName"] = element.tagName;
		if((reducedSearchTree = reducedSearchTree.getElementsByTagName(attributeTypeArray["tagName"])).length == 1) {
			returnArray.push(attributeTypeArray);
			return returnArray;
		}
		
		var tempSearchTree = Array;

		elementAttributes.forEach(function(attributeType) {
			attributeTypeArray[attributeType] = element.getAttribute(attributeType);

			reducedSearchTree.forEach(function(checkingElement, index, reducedTree) {
				if(checkingElement.getAttribute(attributeType) != null) {
					if(checkingElement.getAttribute(attributeType) == element.getAttribute(attributeType)) {
						tempSearchTree.push(checkingElement);
					}
					//do not add if the attribute does not match
				}
				//do not add if it doesnt have the attribute
			});

			reducedSearchTree = tempSearchTree;
			tempSearchTree = Array;
			if(reducedSearchTree.length == 1) {

				returnArray.push(attributeTypeArray);
				return returnArray;
			}
			//else more than one, move to next attribute type
			
		});
		//if got here there is more that needs to be done
		//run determine unique attributes on the parent
		if(element.parentNode == searchTree) {
			//well there is no unique
			returnArray.push("THERE IS NO UNIQUE");
			returnArray.push(attributeTypeArray);
			return returnArray;
		}

		else{
			returnArray = DetermineUniqueAttributes(element.parentNode, searchTree);
			returnArray.push(attributeTypeArray);
			return returnArray;
		}
	}

</script>